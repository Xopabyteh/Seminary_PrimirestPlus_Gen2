(()=>{let e=null;const r="isDeveloper";chrome.tabs.onUpdated.addListener((async(r,t,s)=>{if(!t.status)return;if("complete"!=t.status)return;if(!s.url)return;if(!s.url.includes("mujprimirest.cz"))return;if(s.url.includes("auth"))return;e=s;let o=s.url.split("/"),i=o[o.length-1],a=await n();console.log(a),chrome.tabs.sendMessage(r,{type:"LOAD",tab:s,isDeveloper:a,page:i})}));const t=async(e,r,t)=>{const s=await(async(e,r,t,s)=>{const o=await(async(e,r,t,s)=>`https://www.googleapis.com/customsearch/v1?key=AIzaSyA2R8PmMNUk_YezsELTBNsIU0jWss1-uwQ&cx=c5306d0b9758c45b1&q=${e}&searchType=image&num=${r}&start=${t}&imgSize=${s}&excludeTerms=facebook OR x-raw-image OR tiktok OR denikmalepozitkarky OR cookandme OR function OR docplayer&lr=lang_cs&gl=cs&hl=cs`)(e,r,t,s),n=await fetch(o);return(await n.json()).items})(e,1,r,t);if(void 0!==s)return s[0]},s=["huge","xlarge","xxlarge"],o=async(e,r,n)=>{void 0===n&&(n=0);const i={foodPicture:void 0,searchIndex:r,sizeIndex:n};if(n>=s.length)return i;for(;void 0===i.foodPicture||void 0===i.foodPicture.link||"string"!=typeof i.foodPicture.link||!i.foodPicture.link.includes("https://")||i.foodPicture.link.includes("function");){i.searchIndex++;const a=await t(e,r,s[n]);if(i.foodPicture=a,i.searchIndex>=r+7)return await o(e,0,n+1)}return i},n=async()=>{const e=await chrome.storage.local.get(r);return null==e||null==e.isDeveloper?(chrome.storage.local.set({isDeveloper:!1}),!1):e.isDeveloper};chrome.runtime.onMessage.addListener(((t,s,i)=>{if("TOGGLE_DEVELOPER"==t.type)return(async()=>{const t=!(await chrome.storage.local.get(r)).isDeveloper;chrome.storage.local.set({isDeveloper:t}),chrome.runtime.sendMessage({type:"DEVELOPER_CHANGED",isDeveloper:t}),null!==e&&chrome.tabs.sendMessage(e.id,{type:"DEVELOPER_CHANGED",isDeveloper:t})})(),!1;if("GET_DEVELOPER"==t.type)return n().then((e=>{chrome.runtime.sendMessage({type:"DEVELOPER_CHANGED",isDeveloper:e})})),!1;if("GET_IMAGE"==t.type){console.log(t);const e=t.query,r=t.index,s=t.sizeIndex;return o(e,r,s).then((e=>i(e))),!0}chrome.runtime.lastError&&console.error(chrome.runtime.lastError)}))})();